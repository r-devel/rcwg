[
    {
        "subtype": "bot_message",
        "text": "*[Bug 18898] New: subset option in t.test() won't work properly for paired t-test*\n<https:\/\/bugs.r-project.org\/show_bug.cgi?id=18898>\n\n            Bug ID: 18898\n           Summary: subset option in t.test() won't work properly for\n                    paired t-test\n           Product: R\n           Version: R 4.5.x\n          Hardware: x86_64\/x64\/amd64 (64-bit)\n                OS: Windows 64-bit\n            Status: UNCONFIRMED\n          Severity: normal\n          Priority: P5\n         Component: Analyses\n          Assignee: <mailto:R-core@R-project.org|R-core@R-project.org>\n          Reporter: <mailto:cahn88@gmail.com|cahn88@gmail.com>\n\nI tried paired t-test with subset, but the result is not what I expected.\n\nI used \"anorexia\" data in MASS library.\n\n# the following three work\nlibrary(MASS)\nt.test(Pair(Postwt,Prewt) ~ 1, data = anorexia[anorexia$Treat == 'FT',])\nwith(anorexia[anorexia$Treat == 'FT',], t.test(Pair(Postwt,Prewt) ~ 1))\nwith(anorexia[anorexia$Treat == 'FT',], t.test(Postwt, Prewt, paired = TRUE))\n\n# this won't work\nt.test(Pair(Postwt,Prewt) ~ 1, data=anorexia, subset = (anorexia$Treat ==\n'FT'))",
        "username": "r-bugs notifier",
        "icons": {
            "emoji": ":robot_face:"
        },
        "type": "message",
        "ts": "1748351241.943239",
        "bot_id": "B06769YJX9Q",
        "app_id": "A024R9PQM",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "7isJp",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "[Bug 18898] New: subset option in t.test() won't work properly for paired t-test",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/bugs.r-project.org\/show_bug.cgi?id=18898"
                            },
                            {
                                "type": "text",
                                "text": "\n\n            Bug ID: 18898\n           Summary: subset option in t.test() won't work properly for\n                    paired t-test\n           Product: R\n           Version: R 4.5.x\n          Hardware: x86_64\/x64\/amd64 (64-bit)\n                OS: Windows 64-bit\n            Status: UNCONFIRMED\n          Severity: normal\n          Priority: P5\n         Component: Analyses\n          Assignee: "
                            },
                            {
                                "type": "link",
                                "url": "mailto:R-core@R-project.org",
                                "text": "R-core@R-project.org",
                                "unsafe": true
                            },
                            {
                                "type": "text",
                                "text": "\n          Reporter: "
                            },
                            {
                                "type": "link",
                                "url": "mailto:cahn88@gmail.com",
                                "text": "cahn88@gmail.com"
                            },
                            {
                                "type": "text",
                                "text": "\n\nI tried paired t-test with subset, but the result is not what I expected.\n\nI used \"anorexia\" data in MASS library.\n\n# the following three work\nlibrary(MASS)\nt.test(Pair(Postwt,Prewt) ~ 1, data = anorexia[anorexia$Treat == 'FT',])\nwith(anorexia[anorexia$Treat == 'FT',], t.test(Pair(Postwt,Prewt) ~ 1))\nwith(anorexia[anorexia$Treat == 'FT',], t.test(Postwt, Prewt, paired = TRUE))\n\n# this won't work\nt.test(Pair(Postwt,Prewt) ~ 1, data=anorexia, subset = (anorexia$Treat ==\n'FT'))"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "subtype": "bot_message",
        "text": "*[Bug 18898] subset option in t.test() won't work properly for paired t-test*\n<https:\/\/bugs.r-project.org\/show_bug.cgi?id=18898>\n\nSebastian Meyer (<mailto:seb.meyer@fau.de|seb.meyer@fau.de>) changed:\n\n           What    |Removed                     |Added\n----------------------------------------------------------------------------\n             Status|UNCONFIRMED                 |CONFIRMED\n                 CC|                            |seb.meyer@fau.de\n     Ever confirmed|0                           |1\n\n--- Comment #1 from Sebastian Meyer (<mailto:seb.meyer@fau.de|seb.meyer@fau.de>) ---\nConfirmed, although \"won't work\" is sloppy: sadly there is no error, but a\ndifferent test is performed, the same (nonsensical) as with `c(Postwt,Prewt) ~\n1`. At least this is clear from the output:\n\n```\n&gt; t.test(Pair(Postwt,Prewt) ~ 1, data = MASS::anorexia, subset = Treat == \"FT\")\n\n        One Sample t-test\n\ndata:  Pair(Postwt, Prewt)\nt = 65.051, df = 33, p-value &lt; 2.2e-16\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 84.14511 89.57842\nsample estimates:\nmean of x \n 86.86176 \n\n```\n\nThe issue boils down to `[.data.frame` losing the special \"Pair\" class when\nrows are selected:\n\n```\n&gt; df &lt;- data.frame(response = I(Pair(1,2)))\n&gt; class(df$response)\n[1] \"AsIs\" \"Pair\"\n&gt; class(df[TRUE,,drop=FALSE]$response)\n[1] \"AsIs\"\n```\n\n`t.test.formula` (and `wilcox.test.formula` for that matter) could use explicit\n`terms()` to mark \"Pair\" as special. That attribute does survive the subsetting\noperation.",
        "username": "r-bugs notifier",
        "icons": {
            "emoji": ":robot_face:"
        },
        "type": "message",
        "ts": "1748358553.516349",
        "bot_id": "B06769YJX9Q",
        "app_id": "A024R9PQM",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "wCC",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "[Bug 18898] subset option in t.test() won't work properly for paired t-test",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/bugs.r-project.org\/show_bug.cgi?id=18898"
                            },
                            {
                                "type": "text",
                                "text": "\n\nSebastian Meyer ("
                            },
                            {
                                "type": "link",
                                "url": "mailto:seb.meyer@fau.de",
                                "text": "seb.meyer@fau.de"
                            },
                            {
                                "type": "text",
                                "text": ") changed:\n\n           What    |Removed                     |Added\n----------------------------------------------------------------------------\n             Status|UNCONFIRMED                 |CONFIRMED\n                 CC|                            |seb.meyer@fau.de\n     Ever confirmed|0                           |1\n\n--- Comment #1 from Sebastian Meyer ("
                            },
                            {
                                "type": "link",
                                "url": "mailto:seb.meyer@fau.de",
                                "text": "seb.meyer@fau.de"
                            },
                            {
                                "type": "text",
                                "text": ") ---\nConfirmed, although \"won't work\" is sloppy: sadly there is no error, but a\ndifferent test is performed, the same (nonsensical) as with `c(Postwt,Prewt) ~\n1`. At least this is clear from the output:\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "> t.test(Pair(Postwt,Prewt) ~ 1, data = MASS::anorexia, subset = Treat == \"FT\")\n\n        One Sample t-test\n\ndata:  Pair(Postwt, Prewt)\nt = 65.051, df = 33, p-value < 2.2e-16\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 84.14511 89.57842\nsample estimates:\nmean of x \n 86.86176 \n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\n\nThe issue boils down to "
                            },
                            {
                                "type": "text",
                                "text": "[.data.frame",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " losing the special \"Pair\" class when\nrows are selected:\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "> df <- data.frame(response = I(Pair(1,2)))\n> class(df$response)\n[1] \"AsIs\" \"Pair\"\n> class(df[TRUE,,drop=FALSE]$response)\n[1] \"AsIs\"\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\n\n"
                            },
                            {
                                "type": "text",
                                "text": "t.test.formula",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " (and "
                            },
                            {
                                "type": "text",
                                "text": "wilcox.test.formula",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " for that matter) could use explicit\n"
                            },
                            {
                                "type": "text",
                                "text": "terms()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " to mark \"Pair\" as special. That attribute does survive the subsetting\noperation."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "subtype": "bot_message",
        "text": "*[Bug 18898] subset option in t.test() won't work properly for paired t-test*\n<https:\/\/bugs.r-project.org\/show_bug.cgi?id=18898>\n\n--- Comment #2 from Chaehyung Ahn (<mailto:cahn88@gmail.com|cahn88@gmail.com>) ---\nOh, I see. Thank you for the clarification!!!",
        "username": "r-bugs notifier",
        "icons": {
            "emoji": ":robot_face:"
        },
        "type": "message",
        "ts": "1748359222.260859",
        "bot_id": "B06769YJX9Q",
        "app_id": "A024R9PQM",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "WeW4",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "[Bug 18898] subset option in t.test() won't work properly for paired t-test",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/bugs.r-project.org\/show_bug.cgi?id=18898"
                            },
                            {
                                "type": "text",
                                "text": "\n\n--- Comment #2 from Chaehyung Ahn ("
                            },
                            {
                                "type": "link",
                                "url": "mailto:cahn88@gmail.com",
                                "text": "cahn88@gmail.com"
                            },
                            {
                                "type": "text",
                                "text": ") ---\nOh, I see. Thank you for the clarification!!!"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]