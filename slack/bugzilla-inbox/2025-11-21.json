[
    {
        "subtype": "bot_message",
        "text": "*[Bug 18969] Boxplot should only plot points when &lt; 5 data points*\n<https:\/\/bugs.r-project.org\/show_bug.cgi?id=18969>\n\nMartin Maechler (<mailto:maechler@stat.math.ethz.ch|maechler@stat.math.ethz.ch>) changed:\n\n           What    |Removed                     |Added\n----------------------------------------------------------------------------\n                 CC|                            |maechler@stat.math.ethz.ch\n\n--- Comment #2 from Martin Maechler (<mailto:maechler@stat.math.ethz.ch|maechler@stat.math.ethz.ch>) ---\nI pretty strongly disagree that there is any bug, at least not from what I see\nhere.\nThe plots I get from `boxplot(1:2)` or `(1:3)`  seem perfect to me.\n\nDid you search for previous discussions on this issue\n(I vaguely remember seeing them, and being involved in at least one)?\n\nIn R we have tried hard to write functions in a way they also work for boundary\ncases...\nYour report is currently very invalid or at least incomplete.\n\nYour subject is \".. should not ..\" is just claim which I do not agree with at\nall.",
        "username": "r-bugs notifier",
        "icons": {
            "emoji": ":robot_face:"
        },
        "type": "message",
        "ts": "1763716369.025889",
        "bot_id": "B06769YJX9Q",
        "app_id": "A024R9PQM",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "ET=Tc",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "[Bug 18969] Boxplot should only plot points when < 5 data points",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/bugs.r-project.org\/show_bug.cgi?id=18969"
                            },
                            {
                                "type": "text",
                                "text": "\n\nMartin Maechler ("
                            },
                            {
                                "type": "link",
                                "url": "mailto:maechler@stat.math.ethz.ch",
                                "text": "maechler@stat.math.ethz.ch",
                                "unsafe": true
                            },
                            {
                                "type": "text",
                                "text": ") changed:\n\n           What    |Removed                     |Added\n----------------------------------------------------------------------------\n                 CC|                            |maechler@stat.math.ethz.ch\n\n--- Comment #2 from Martin Maechler ("
                            },
                            {
                                "type": "link",
                                "url": "mailto:maechler@stat.math.ethz.ch",
                                "text": "maechler@stat.math.ethz.ch",
                                "unsafe": true
                            },
                            {
                                "type": "text",
                                "text": ") ---\nI pretty strongly disagree that there is any bug, at least not from what I see\nhere.\nThe plots I get from "
                            },
                            {
                                "type": "text",
                                "text": "boxplot(1:2)",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " or "
                            },
                            {
                                "type": "text",
                                "text": "(1:3)",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "  seem perfect to me.\n\nDid you search for previous discussions on this issue\n(I vaguely remember seeing them, and being involved in at least one)?\n\nIn R we have tried hard to write functions in a way they also work for boundary\ncases...\nYour report is currently very invalid or at least incomplete.\n\nYour subject is \".. should not ..\" is just claim which I do not agree with at\nall."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "subtype": "bot_message",
        "text": "*[Bug 18969] Suggest boxplot to only plot points when there are &lt; 5 data points*\n<https:\/\/bugs.r-project.org\/show_bug.cgi?id=18969>\n\n--- Comment #3 from Alwin Wang (<mailto:alwang18@hotmail.com|alwang18@hotmail.com>) ---\nHi Martin, thank you for the quick feedback. Apologies for the incompleteness\nof this bug report, I was trying to succinctly capture the discussion at\ntoday's R Dev Day and I wasn't present for other discussions prior to today.\n\nI'll check with the R Dev Day focals on the history of this patch request, as\nthe consensus today was that a box plot with a five number summary constructed\nof 2, 3, or 4 points may be misleading to the user. The suggestion is to plot\nthe points themselves which could be more meaningful to the user. I've also\nupdated the subject of this bug as well, thanks.",
        "username": "r-bugs notifier",
        "icons": {
            "emoji": ":robot_face:"
        },
        "type": "message",
        "ts": "1763720639.682689",
        "bot_id": "B06769YJX9Q",
        "app_id": "A024R9PQM",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "s6Fr4",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "[Bug 18969] Suggest boxplot to only plot points when there are < 5 data points",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/bugs.r-project.org\/show_bug.cgi?id=18969"
                            },
                            {
                                "type": "text",
                                "text": "\n\n--- Comment #3 from Alwin Wang ("
                            },
                            {
                                "type": "link",
                                "url": "mailto:alwang18@hotmail.com",
                                "text": "alwang18@hotmail.com"
                            },
                            {
                                "type": "text",
                                "text": ") ---\nHi Martin, thank you for the quick feedback. Apologies for the incompleteness\nof this bug report, I was trying to succinctly capture the discussion at\ntoday's R Dev Day and I wasn't present for other discussions prior to today.\n\nI'll check with the R Dev Day focals on the history of this patch request, as\nthe consensus today was that a box plot with a five number summary constructed\nof 2, 3, or 4 points may be misleading to the user. The suggestion is to plot\nthe points themselves which could be more meaningful to the user. I've also\nupdated the subject of this bug as well, thanks."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "subtype": "bot_message",
        "text": "*[Bug 18970] New: wrapper around `proportions()` to ease publication-like table preparation [with patch]*\n<https:\/\/bugs.r-project.org\/show_bug.cgi?id=18970>\n\n            Bug ID: 18970\n           Summary: wrapper around `proportions()` to ease\n                    publication-like table preparation [with patch]\n           Product: R\n           Version: R-devel (trunk)\n          Hardware: All\n                OS: All\n            Status: UNCONFIRMED\n          Severity: enhancement\n          Priority: P5\n         Component: Wishlist\n          Assignee: <mailto:R-core@R-project.org|R-core@R-project.org>\n          Reporter: <mailto:Thomas.SOEIRO@ap-hm.fr|Thomas.SOEIRO@ap-hm.fr>\n\nCreated attachment 3567\n  --&gt; <https:\/\/bugs.r-project.org\/attachment.cgi?id=3567&amp;action=edit>\ncode and documentation patch\n\nI would like to propose a simple wrapper around `proportions()` for\nconsideration by R-core. The goal is to ease publication-like table preparation\nwith base R. The function adds proportions back to the original table or array,\nformatted according to `fmt` and excluding `NA`s. Given the large number of\npackages that aim to ease producing publication-ready tables, this seems to be\na very common need.\n\n\n```\nadd_proportions &lt;- function(x, ..., mult = 100, fmt = \"%.0f (%.1f)\")\n{\n    stopifnot(is.numeric(mult), length(mult) == 1, length(fmt) == 1)\n    dn_nona &lt;- lapply(dimnames(x), stats::na.omit)\n    x_nona &lt;- do.call(`[`, c(list(x), dn_nona, drop = FALSE))\n    prop &lt;- proportions(x_nona, ...) * mult\n    out &lt;- sprintf(fmt, x_nona, prop)\n    do.call(`[&lt;-`, c(list(x), dn_nona, list(out)))\n}\n```\n\nExample from `?proportions`:\n\n```\nDF &lt;- as.data.frame(UCBAdmissions)\ntbl &lt;- xtabs(Freq ~ Gender + Admit, DF)\nadd_proportions(tbl)\n#         Admit\n# Gender   Admitted    Rejected   \n#   Male   1198 (26.5) 1493 (33.0)\n#   Female 557 (12.3)  1278 (28.2)\n```\n\nWith `NA`s:\n\n```\nwarpbreaks[c(1, 2, 10), \"wool\"] &lt;- NA\ntbl_na &lt;- table(warpbreaks[-1], useNA = \"ifany\")\nadd_proportions(tbl_na)\n#       tension\n# wool   L        M        H       \n#   A    7 (13.7) 8 (15.7) 9 (17.6)\n#   B    9 (17.6) 9 (17.6) 9 (17.6)\n#   &lt;NA&gt; 2        1        0\n```\n\nAs `add_proportions()` is a simple wrapper around `proportions()`, it\nintegrates with other base R functions, e.g. `addmargins()`:\n\n```\ntbl_na |&gt; addmargins(margin = 2) |&gt; add_proportions(margin = 2)\n#       tension\n# wool   L        M        H        Sum      \n#   A    7 (43.8) 8 (47.1) 9 (50.0) 24 (47.1)\n#   B    9 (56.2) 9 (52.9) 9 (50.0) 27 (52.9)\n#   &lt;NA&gt; 2        1        0        3\n\ntbl |&gt; addmargins() |&gt; add_proportions(mult = 100 * 4)\n#         Admit\n# Gender   Admitted    Rejected    Sum         \n#   Male   1198 (26.5) 1493 (33.0) 2691 (59.5) \n#   Female 557 (12.3)  1278 (28.2) 1835 (40.5) \n#   Sum    1755 (38.8) 2771 (61.2) 4526 (100.0)\n```\n\nNotes regarding the code:\n\n- `fmt` uses `%.0f` rather than `%d` to prevent errors e.g. for `xtabs(mpg ~\nvs, mtcars) |&gt; add_proportions()`. Perhaps defaulting to `%d` to raise an error\nwould be more defensive?\n- `drop = FALSE` is needed e.g. for `table(c(1, 1, 1, NA), c(1, 2, 2, 2), useNA\n= \"ifany\") |&gt; add_proportions(margin = 2)`.\n- It is possible to get non-sensical results with inappropriate combinations of\nmargins, e.g. `tbl_na |&gt; addmargins(margin = 1) |&gt; add_proportions(margin = 2,\nmult = 100 * 2)`. Perhaps this should be mentioned in the documentation?",
        "username": "r-bugs notifier",
        "icons": {
            "emoji": ":robot_face:"
        },
        "type": "message",
        "ts": "1763728571.690359",
        "bot_id": "B06769YJX9Q",
        "app_id": "A024R9PQM",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "7p6",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "[Bug 18970] New: wrapper around ",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "proportions()",
                                "style": {
                                    "bold": true,
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " to ease publication-like table preparation [with patch]",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/bugs.r-project.org\/show_bug.cgi?id=18970"
                            },
                            {
                                "type": "text",
                                "text": "\n\n            Bug ID: 18970\n           Summary: wrapper around "
                            },
                            {
                                "type": "text",
                                "text": "proportions()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " to ease\n                    publication-like table preparation [with patch]\n           Product: R\n           Version: R-devel (trunk)\n          Hardware: All\n                OS: All\n            Status: UNCONFIRMED\n          Severity: enhancement\n          Priority: P5\n         Component: Wishlist\n          Assignee: "
                            },
                            {
                                "type": "link",
                                "url": "mailto:R-core@R-project.org",
                                "text": "R-core@R-project.org",
                                "unsafe": true
                            },
                            {
                                "type": "text",
                                "text": "\n          Reporter: "
                            },
                            {
                                "type": "link",
                                "url": "mailto:Thomas.SOEIRO@ap-hm.fr",
                                "text": "Thomas.SOEIRO@ap-hm.fr",
                                "unsafe": true
                            },
                            {
                                "type": "text",
                                "text": "\n\nCreated attachment 3567\n  --> "
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/bugs.r-project.org\/attachment.cgi?id=3567&amp;action=edit",
                                "text": "https:\/\/bugs.r-project.org\/attachment.cgi?id=3567&action=edit"
                            },
                            {
                                "type": "text",
                                "text": "\ncode and documentation patch\n\nI would like to propose a simple wrapper around "
                            },
                            {
                                "type": "text",
                                "text": "proportions()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " for\nconsideration by R-core. The goal is to ease publication-like table preparation\nwith base R. The function adds proportions back to the original table or array,\nformatted according to "
                            },
                            {
                                "type": "text",
                                "text": "fmt",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " and excluding "
                            },
                            {
                                "type": "text",
                                "text": "NA",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "s. Given the large number of\npackages that aim to ease producing publication-ready tables, this seems to be\na very common need.\n\n\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "add_proportions <- function(x, ..., mult = 100, fmt = \"%.0f (%.1f)\")\n{\n    stopifnot(is.numeric(mult), length(mult) == 1, length(fmt) == 1)\n    dn_nona <- lapply(dimnames(x), stats::na.omit)\n    x_nona <- do.call(`[`, c(list(x), dn_nona, drop = FALSE))\n    prop <- proportions(x_nona, ...) * mult\n    out <- sprintf(fmt, x_nona, prop)\n    do.call(`[<-`, c(list(x), dn_nona, list(out)))\n}\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\n\nExample from "
                            },
                            {
                                "type": "text",
                                "text": "?proportions",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": ":\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "DF <- as.data.frame(UCBAdmissions)\ntbl <- xtabs(Freq ~ Gender + Admit, DF)\nadd_proportions(tbl)\n#         Admit\n# Gender   Admitted    Rejected   \n#   Male   1198 (26.5) 1493 (33.0)\n#   Female 557 (12.3)  1278 (28.2)\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\n\nWith "
                            },
                            {
                                "type": "text",
                                "text": "NA",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "s:\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "warpbreaks[c(1, 2, 10), \"wool\"] <- NA\ntbl_na <- table(warpbreaks[-1], useNA = \"ifany\")\nadd_proportions(tbl_na)\n#       tension\n# wool   L        M        H       \n#   A    7 (13.7) 8 (15.7) 9 (17.6)\n#   B    9 (17.6) 9 (17.6) 9 (17.6)\n#   <NA> 2        1        0\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\n\nAs "
                            },
                            {
                                "type": "text",
                                "text": "add_proportions()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " is a simple wrapper around "
                            },
                            {
                                "type": "text",
                                "text": "proportions()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": ", it\nintegrates with other base R functions, e.g. "
                            },
                            {
                                "type": "text",
                                "text": "addmargins()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": ":\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "tbl_na |> addmargins(margin = 2) |> add_proportions(margin = 2)\n#       tension\n# wool   L        M        H        Sum      \n#   A    7 (43.8) 8 (47.1) 9 (50.0) 24 (47.1)\n#   B    9 (56.2) 9 (52.9) 9 (50.0) 27 (52.9)\n#   <NA> 2        1        0        3\n\ntbl |> addmargins() |> add_proportions(mult = 100 * 4)\n#         Admit\n# Gender   Admitted    Rejected    Sum         \n#   Male   1198 (26.5) 1493 (33.0) 2691 (59.5) \n#   Female 557 (12.3)  1278 (28.2) 1835 (40.5) \n#   Sum    1755 (38.8) 2771 (61.2) 4526 (100.0)\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\n\nNotes regarding the code:\n\n- "
                            },
                            {
                                "type": "text",
                                "text": "fmt",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " uses "
                            },
                            {
                                "type": "text",
                                "text": "%.0f",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " rather than "
                            },
                            {
                                "type": "text",
                                "text": "%d",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " to prevent errors e.g. for `xtabs(mpg ~\nvs, mtcars) |> add_proportions()`. Perhaps defaulting to "
                            },
                            {
                                "type": "text",
                                "text": "%d",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " to raise an error\nwould be more defensive?\n- "
                            },
                            {
                                "type": "text",
                                "text": "drop = FALSE",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " is needed e.g. for `table(c(1, 1, 1, NA), c(1, 2, 2, 2), useNA\n= \"ifany\") |> add_proportions(margin = 2)`.\n- It is possible to get non-sensical results with inappropriate combinations of\nmargins, e.g. `tbl_na |> addmargins(margin = 1) |> add_proportions(margin = 2,\nmult = 100 * 2)`. Perhaps this should be mentioned in the documentation?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "subtype": "bot_message",
        "text": "*[Bug 2606] modifying ftable to allow percentages (wishlist)*\n<https:\/\/bugs.r-project.org\/show_bug.cgi?id=2606>\n\nThomas Soeiro (<mailto:Thomas.SOEIRO@ap-hm.fr|Thomas.SOEIRO@ap-hm.fr>) changed:\n\n           What    |Removed                     |Added\n----------------------------------------------------------------------------\n                 CC|                            |Thomas.SOEIRO@ap-hm.fr\n\n--- Comment #3 from Thomas Soeiro (<mailto:Thomas.SOEIRO@ap-hm.fr|Thomas.SOEIRO@ap-hm.fr>) ---\nThe desired output can be achieved using `proportions()`. Instead of adding a\ndedicated argument to `ftable()`, it may be enough to include examples in\n`?ftable`. This would maintain consistency with `table()` and `xtabs()`.\n\nHere are examples:\n\n```\nmt &lt;- mtcars[c(\"cyl\", \"vs\", \"am\")]\n\nidentical(\n    ftable(mt, pcnt = \"gtotal\"),\n    ftable(mt) |&gt; proportions() * 100\n)\n# [1] TRUE\n\nidentical(\n  ftable(mt, pcnt = \"row\"),\n  table(mt) |&gt; proportions(margin = 1:2) |&gt; ftable() * 100\n)\n# [1] TRUE\n\nidentical(\n  ftable(mt, pcnt = \"column\"),\n  table(mt) |&gt; proportions(margin = 2:3) |&gt; ftable() * 100\n)\n# [1] TRUE\n\nidentical(\n  ftable(mt, pcnt = \"total\"),\n  table(mt) |&gt; proportions(margin = 2) |&gt; ftable() * 100\n)\n# [1] TRUE\n```\n\nWith this patch (suggested in comment 0) applied:\n\n```\n--- \/cygdrive\/c\/Users\/A141800\/Downloads\/ftable.R        2025-11-21\n13:41:44.650730900 +0100\n+++ \/cygdrive\/c\/Users\/A141800\/Downloads\/ftable2.R       2025-11-21\n14:56:34.905310700 +0100\n@@ -19,7 +19,8 @@\n ftable &lt;- function(x, ...) UseMethod(\"ftable\")\n\n ftable.default &lt;- function(..., exclude = c(NA, NaN),\n-                          row.vars = NULL, col.vars = NULL) {\n+                          row.vars = NULL, col.vars = NULL,\n+                          pcnt = c(\"n\", \"row\", \"column\", \"total\", \"gtotal\")) {\n     args &lt;- list(...)\n     if (length(args) == 0L)\n        stop(\"nothing to tabulate\")\n@@ -76,6 +77,20 @@\n\n     if(length(perm &lt;- c(rev(row.vars), rev(col.vars))) &gt; 1)\n        x &lt;- aperm(x, perm)\n+    pcnt &lt;- match.arg(pcnt)\n+    if (pcnt != \"n\") {\n+        if (pcnt == \"gtotal\")\n+            x &lt;- prop.table(x) * 100\n+        else {\n+            mrg2drop &lt;- switch(pcnt,\n+                               row = col.vars[length(col.vars)],\n+                               column = row.vars[length(row.vars)],\n+                               total = c(col.vars[length(col.vars)],\n+                                         row.vars[length(row.vars)]),\n+                               gtotal = 0)\n+            x &lt;- prop.table(x, i[-mrg2drop]) * 100\n+        }\n+    }\n     dim(x) &lt;- c(prod(dx[row.vars]), prod(dx[col.vars]))\n     attr(x, \"row.vars\") &lt;- dn[row.vars]\n     attr(x, \"col.vars\") &lt;- dn[col.vars]\n@@ -126,7 +141,7 @@\n                 stop(\"incorrect variable names in lhs of formula\")\n             cvars &lt;- i\n         }\n-        ftable(data, row.vars = rvars, col.vars = cvars)\n+        ftable(data, row.vars = rvars, col.vars = cvars, ...)\n     }\n     else {\n         if(is.matrix(edata))\n```",
        "username": "r-bugs notifier",
        "icons": {
            "emoji": ":robot_face:"
        },
        "type": "message",
        "ts": "1763734038.386319",
        "bot_id": "B06769YJX9Q",
        "app_id": "A024R9PQM",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "6u+OM",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "[Bug 2606] modifying ftable to allow percentages (wishlist)",
                                "style": {
                                    "bold": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/bugs.r-project.org\/show_bug.cgi?id=2606"
                            },
                            {
                                "type": "text",
                                "text": "\n\nThomas Soeiro ("
                            },
                            {
                                "type": "link",
                                "url": "mailto:Thomas.SOEIRO@ap-hm.fr",
                                "text": "Thomas.SOEIRO@ap-hm.fr",
                                "unsafe": true
                            },
                            {
                                "type": "text",
                                "text": ") changed:\n\n           What    |Removed                     |Added\n----------------------------------------------------------------------------\n                 CC|                            |Thomas.SOEIRO@ap-hm.fr\n\n--- Comment #3 from Thomas Soeiro ("
                            },
                            {
                                "type": "link",
                                "url": "mailto:Thomas.SOEIRO@ap-hm.fr",
                                "text": "Thomas.SOEIRO@ap-hm.fr",
                                "unsafe": true
                            },
                            {
                                "type": "text",
                                "text": ") ---\nThe desired output can be achieved using "
                            },
                            {
                                "type": "text",
                                "text": "proportions()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": ". Instead of adding a\ndedicated argument to "
                            },
                            {
                                "type": "text",
                                "text": "ftable()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": ", it may be enough to include examples in\n"
                            },
                            {
                                "type": "text",
                                "text": "?ftable",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": ". This would maintain consistency with "
                            },
                            {
                                "type": "text",
                                "text": "table()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " and "
                            },
                            {
                                "type": "text",
                                "text": "xtabs()",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": ".\n\nHere are examples:\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "mt <- mtcars[c(\"cyl\", \"vs\", \"am\")]\n\nidentical(\n    ftable(mt, pcnt = \"gtotal\"),\n    ftable(mt) |> proportions() * 100\n)\n# [1] TRUE\n\nidentical(\n  ftable(mt, pcnt = \"row\"),\n  table(mt) |> proportions(margin = 1:2) |> ftable() * 100\n)\n# [1] TRUE\n\nidentical(\n  ftable(mt, pcnt = \"column\"),\n  table(mt) |> proportions(margin = 2:3) |> ftable() * 100\n)\n# [1] TRUE\n\nidentical(\n  ftable(mt, pcnt = \"total\"),\n  table(mt) |> proportions(margin = 2) |> ftable() * 100\n)\n# [1] TRUE\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\n\nWith this patch (suggested in comment 0) applied:\n\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "--- \/cygdrive\/c\/Users\/A141800\/Downloads\/ftable.R        2025-11-21\n13:41:44.650730900 +0100\n+++ \/cygdrive\/c\/Users\/A141800\/Downloads\/ftable2.R       2025-11-21\n14:56:34.905310700 +0100\n@@ -19,7 +19,8 @@\n ftable <- function(x, ...) UseMethod(\"ftable\")\n\n ftable.default <- function(..., exclude = c(NA, NaN),\n-                          row.vars = NULL, col.vars = NULL) {\n+                          row.vars = NULL, col.vars = NULL,\n+                          pcnt = c(\"n\", \"row\", \"column\", \"total\", \"gtotal\")) {\n     args <- list(...)\n     if (length(args) == 0L)\n        stop(\"nothing to tabulate\")\n@@ -76,6 +77,20 @@\n\n     if(length(perm <- c(rev(row.vars), rev(col.vars))) > 1)\n        x <- aperm(x, perm)\n+    pcnt <- match.arg(pcnt)\n+    if (pcnt != \"n\") {\n+        if (pcnt == \"gtotal\")\n+            x <- prop.table(x) * 100\n+        else {\n+            mrg2drop <- switch(pcnt,\n+                               row = col.vars[length(col.vars)],\n+                               column = row.vars[length(row.vars)],\n+                               total = c(col.vars[length(col.vars)],\n+                                         row.vars[length(row.vars)]),\n+                               gtotal = 0)\n+            x <- prop.table(x, i[-mrg2drop]) * 100\n+        }\n+    }\n     dim(x) <- c(prod(dx[row.vars]), prod(dx[col.vars]))\n     attr(x, \"row.vars\") <- dn[row.vars]\n     attr(x, \"col.vars\") <- dn[col.vars]\n@@ -126,7 +141,7 @@\n                 stop(\"incorrect variable names in lhs of formula\")\n             cvars <- i\n         }\n-        ftable(data, row.vars = rvars, col.vars = cvars)\n+        ftable(data, row.vars = rvars, col.vars = cvars, ...)\n     }\n     else {\n         if(is.matrix(edata))\n"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]