[
    {
        "user": "U07MWC5T8FJ",
        "type": "message",
        "ts": "1764761714.958219",
        "client_msg_id": "d13b429b-c77e-46c0-97be-a34f8f1ef237",
        "text": "I've discovered multiple definitions of the same thing in the r-source. One however is unlike the other two:\n```\/\/builtin.c\n#define simple_as_environment(arg) (IS_S4_OBJECT(arg) &amp;&amp; (TYPEOF(arg) == OBJSXP) ? R_getS4DataSlot(arg, ENVSXP) : arg)\n\/\/envir.c\n#define simple_as_environment(arg) (IS_S4_OBJECT(arg) &amp;&amp; (TYPEOF(arg) == OBJSXP) ? R_getS4DataSlot(arg, ENVSXP) : R_NilValue)\n\/\/eval.c\n#define simple_as_environment(arg) (IS_S4_OBJECT(arg) &amp;&amp; (TYPEOF(arg) == OBJSXP) ? R_getS4DataSlot(arg, ENVSXP) : R_NilValue)```",
        "team": "T01DW9DLB2A",
        "user_team": "T01DW9DLB2A",
        "source_team": "T01DW9DLB2A",
        "user_profile": {
            "avatar_hash": "gbd5b8649a4e",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/bd5b8649a4e2d5913c1d2981dc691c79.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "Mossa",
            "real_name": "Mossa",
            "display_name": "Mossa",
            "team": "T01DW9DLB2A",
            "name": "cgmossa",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1764761714.958219",
        "reply_count": 8,
        "reply_users_count": 3,
        "latest_reply": "1765213781.227839",
        "reply_users": [
            "U07MWC5T8FJ",
            "U01KXU8UNRX",
            "U01JACR6L7L"
        ],
        "replies": [
            {
                "user": "U07MWC5T8FJ",
                "ts": "1764779918.183089"
            },
            {
                "user": "U01KXU8UNRX",
                "ts": "1764795408.327539"
            },
            {
                "user": "U07MWC5T8FJ",
                "ts": "1764796571.023629"
            },
            {
                "user": "U01KXU8UNRX",
                "ts": "1765104689.400739"
            },
            {
                "user": "U01KXU8UNRX",
                "ts": "1765104764.057979"
            },
            {
                "user": "U07MWC5T8FJ",
                "ts": "1765104836.467749"
            },
            {
                "user": "U07MWC5T8FJ",
                "ts": "1765104910.697989"
            },
            {
                "user": "U01JACR6L7L",
                "ts": "1765213781.227839"
            }
        ],
        "is_locked": false,
        "subscribed": false,
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "kKbwC",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I've discovered multiple definitions of the same thing in the r-source. One however is unlike the other two:\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\/\/builtin.c\n#define simple_as_environment(arg) (IS_S4_OBJECT(arg) && (TYPEOF(arg) == OBJSXP) ? R_getS4DataSlot(arg, ENVSXP) : arg)\n\/\/envir.c\n#define simple_as_environment(arg) (IS_S4_OBJECT(arg) && (TYPEOF(arg) == OBJSXP) ? R_getS4DataSlot(arg, ENVSXP) : R_NilValue)\n\/\/eval.c\n#define simple_as_environment(arg) (IS_S4_OBJECT(arg) && (TYPEOF(arg) == OBJSXP) ? R_getS4DataSlot(arg, ENVSXP) : R_NilValue)"
                            }
                        ],
                        "border": 0
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "sweat_smile",
                "users": [
                    "U01KXU8UNRX"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U07MWC5T8FJ",
        "type": "message",
        "ts": "1764779918.183089",
        "client_msg_id": "71edab40-f859-41d6-a905-d78d92a690e9",
        "text": "I can't really tell if this is even a bug. Can anyone?",
        "team": "T01DW9DLB2A",
        "user_team": "T01DW9DLB2A",
        "source_team": "T01DW9DLB2A",
        "user_profile": {
            "avatar_hash": "gbd5b8649a4e",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/bd5b8649a4e2d5913c1d2981dc691c79.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "Mossa",
            "real_name": "Mossa",
            "display_name": "Mossa",
            "team": "T01DW9DLB2A",
            "name": "cgmossa",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1764761714.958219",
        "parent_user_id": "U07MWC5T8FJ",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "ucEqb",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I can't really tell if this is even a bug. Can anyone?"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U07MWC5T8FJ",
        "type": "message",
        "ts": "1764780965.507989",
        "client_msg_id": "f508309a-c697-4e6b-a788-5842d44a9376",
        "text": "I believe this is a bug comparison that should be fixed:\n<https:\/\/github.com\/r-devel\/r-svn\/blob\/671453f7c085d503dff55b533797f58d789e5510\/src\/main\/altclasses.c#L1375-L1376>\nthe line is\n```    if (TYPEOF(file) != STRSXP || LENGTH(file) != 1 || file == NA_STRING)```\nso the assumption at `file == NA_STRING` is that `file` is `STRSXP`. But whenever I look for `== NA_STRING` , I see stuff like:\n```\tSEXP this = STRING_ELT(text, i);\n\tif (this == NA_STRING) {```\nyou can find other examples, but essentially, STRING_ELT needs to be used.\nI suspect that `STRING_ELT(file,0) == NA_STRING` is needed here. I don't assume that a CHARSXP (the return value of STRING_ELT) is equivalent to a size=1, `STRSXP`.",
        "team": "T01DW9DLB2A",
        "user_team": "T01DW9DLB2A",
        "source_team": "T01DW9DLB2A",
        "user_profile": {
            "avatar_hash": "gbd5b8649a4e",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/bd5b8649a4e2d5913c1d2981dc691c79.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "Mossa",
            "real_name": "Mossa",
            "display_name": "Mossa",
            "team": "T01DW9DLB2A",
            "name": "cgmossa",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1764780965.507989",
        "reply_count": 2,
        "reply_users_count": 2,
        "latest_reply": "1765214458.104139",
        "reply_users": [
            "U033CD64FS4",
            "U07MWC5T8FJ"
        ],
        "replies": [
            {
                "user": "U033CD64FS4",
                "ts": "1764817218.727259"
            },
            {
                "user": "U07MWC5T8FJ",
                "ts": "1765214458.104139"
            }
        ],
        "is_locked": false,
        "subscribed": false,
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Mab6Z",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I believe this is a bug comparison that should be fixed:\n"
                            },
                            {
                                "type": "link",
                                "url": "https:\/\/github.com\/r-devel\/r-svn\/blob\/671453f7c085d503dff55b533797f58d789e5510\/src\/main\/altclasses.c#L1375-L1376"
                            },
                            {
                                "type": "text",
                                "text": "\nthe line is\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "    if (TYPEOF(file) != STRSXP || LENGTH(file) != 1 || file == NA_STRING)"
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "so the assumption at "
                            },
                            {
                                "type": "text",
                                "text": "file == NA_STRING",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " is that "
                            },
                            {
                                "type": "text",
                                "text": "file",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " is "
                            },
                            {
                                "type": "text",
                                "text": "STRSXP",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": ". But whenever I look for "
                            },
                            {
                                "type": "text",
                                "text": "== NA_STRING",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " , I see stuff like:\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\tSEXP this = STRING_ELT(text, i);\n\tif (this == NA_STRING) {"
                            }
                        ],
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "you can find other examples, but essentially, STRING_ELT needs to be used.\nI suspect that "
                            },
                            {
                                "type": "text",
                                "text": "STRING_ELT(file,0) == NA_STRING",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": " is needed here. I don't assume that a CHARSXP (the return value of STRING_ELT) is equivalent to a size=1, "
                            },
                            {
                                "type": "text",
                                "text": "STRSXP",
                                "style": {
                                    "code": true
                                }
                            },
                            {
                                "type": "text",
                                "text": "."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U01KXU8UNRX",
        "type": "message",
        "ts": "1764795408.327539",
        "client_msg_id": "b88199cb-2b96-4c0c-a4fe-d998a758e1d3",
        "text": "I'm not versed on C but I would either reuse the definition across files or name them differently. This might be worth checking on R-devel mailing list (if no one else helps here).",
        "team": "T01DW9DLB2A",
        "user_team": "T01DW9DLB2A",
        "source_team": "T01DW9DLB2A",
        "user_profile": {
            "avatar_hash": "fecc4cdbe3c3",
            "image_72": "https:\/\/avatars.slack-edge.com\/2025-11-30\/10014284642259_fecc4cdbe3c3c0b20748_72.jpg",
            "first_name": "Lluís",
            "real_name": "Lluís Revilla Sancho",
            "display_name": "Lluís Revilla Sancho",
            "team": "T01DW9DLB2A",
            "name": "lluis.revilla_slack",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1764761714.958219",
        "parent_user_id": "U07MWC5T8FJ",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "kJYeD",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I'm not versed on C but I would either reuse the definition across files or name them differently. This might be worth checking on R-devel mailing list (if no one else helps here)."
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "user": "U07MWC5T8FJ",
        "type": "message",
        "ts": "1764796571.023629",
        "client_msg_id": "8361904b-aa01-4588-83b4-52baa1c88953",
        "text": "I have many things like this, and I feel a strong aversion against engaging the mailing list.",
        "team": "T01DW9DLB2A",
        "user_team": "T01DW9DLB2A",
        "source_team": "T01DW9DLB2A",
        "user_profile": {
            "avatar_hash": "gbd5b8649a4e",
            "image_72": "https:\/\/secure.gravatar.com\/avatar\/bd5b8649a4e2d5913c1d2981dc691c79.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0023-72.png",
            "first_name": "Mossa",
            "real_name": "Mossa",
            "display_name": "Mossa",
            "team": "T01DW9DLB2A",
            "name": "cgmossa",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1764761714.958219",
        "parent_user_id": "U07MWC5T8FJ",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "v8Aoj",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "I have many things like this, and I feel a strong aversion against engaging the mailing list."
                            }
                        ]
                    }
                ]
            }
        ],
        "reactions": [
            {
                "name": "eyes",
                "users": [
                    "U01KXU8UNRX"
                ],
                "count": 1
            }
        ]
    },
    {
        "user": "U033CD64FS4",
        "type": "message",
        "ts": "1764817218.727259",
        "client_msg_id": "b57732d6-87c1-4375-9c7d-55caafcedbd1",
        "text": "Your analysis is correct",
        "team": "T01DW9DLB2A",
        "user_team": "T01DW9DLB2A",
        "source_team": "T01DW9DLB2A",
        "user_profile": {
            "avatar_hash": "8ca4e7a47a0c",
            "image_72": "https:\/\/avatars.slack-edge.com\/2022-02-10\/3103315181841_8ca4e7a47a0c1ee8c851_72.jpg",
            "first_name": "Mikael",
            "real_name": "Mikael Jagan",
            "display_name": "Mikael Jagan",
            "team": "T01DW9DLB2A",
            "name": "jaganmn2",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1764780965.507989",
        "parent_user_id": "U07MWC5T8FJ",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "\/1Y4O",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Your analysis is correct"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]